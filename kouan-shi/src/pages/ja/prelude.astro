---
import ScriptureLayout from '../../layouts/ScriptureLayout.astro';

const verseImports = import.meta.glob('../../content/scriptures/ja/prelude/*.md', { query: '?raw', import: 'default' });

const versesData: Record<number, string> = {};
for (const path in verseImports) {
  const verseNum = parseInt(path.split('/').pop()!.replace('.md', ''));
  if (!isNaN(verseNum)) {
    const content = await verseImports[path]();
    versesData[verseNum] = content as string;
  }
}

const verseNumbers = Object.keys(versesData).map(Number).sort((a, b) => a - b);

const kanjiNumerals = ["〇", "一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "二十一", "二十二", "二十三", "二十四", "二十五", "二十六", "二十七", "二十八", "二十九", "三十", "三十一", "三十二", "三十三", "三十四", "三十五", "三十六", "三十七", "三十八", "三十九", "四十"];
---
<ScriptureLayout
  lang="ja"
  title="光闇詞 - 前詞四十節"
  font="Noto Serif JP"
  fontUrl="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&display=swap"
  chapterTitle="前詞四十節"
  backLabel="章選択へ戻る"
  defaultHeading="前詞"
  defaultMessage="目次より、お読みになりたい節を選択してください。"
  storageKey="preludeScrollPos"
  versesData={versesData}
>
  {verseNumbers.map((num) => (
    <li><a href="#" data-verse-num={num}>第{kanjiNumerals[num]}節</a></li>
  ))}
</ScriptureLayout>
