---
import ScriptureLayout from '../../layouts/ScriptureLayout.astro';

const verseImports = import.meta.glob('../../content/scriptures/en/prelude/*.md', { query: '?raw', import: 'default' });

const versesData: Record<number, string> = {};
for (const path in verseImports) {
  const verseNum = parseInt(path.split('/').pop()!.replace('.md', ''));
  if (!isNaN(verseNum)) {
    const content = await verseImports[path]();
    versesData[verseNum] = content as string;
  }
}

const verseNumbers = Object.keys(versesData).map(Number).sort((a, b) => a - b);
---
<ScriptureLayout
  lang="en"
  title="The Hymn of Light and Shadow - Prelude"
  font="Noto Serif"
  fontUrl="https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&display=swap"
  chapterTitle="Prelude - 40 Verses"
  backLabel="Back to Chapter Selection"
  defaultHeading="Prelude"
  defaultMessage="Please select a verse from the index."
  storageKey="enPreludeScrollPos"
  versesData={versesData}
>
  {verseNumbers.map((num) => (
    <li><a href="#" data-verse-num={num}>Verse {num}</a></li>
  ))}
</ScriptureLayout>
