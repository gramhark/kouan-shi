# GitHub Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
name: Deploy to GitHub Pages

# mainãƒ–ãƒ©ãƒ³ãƒã«ã‚³ãƒ¼ãƒ‰ãŒpushã•ã‚ŒãŸã¨ãã«ã€ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã—ã¾ã™
on:
  push:
    branches:
      - main

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æ¨©é™ã‚’è¨­å®š
permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          cache-dependency-path: 'kouan-shi/package-lock.json' # package-lock.jsonã®å ´æ‰€ã‚’æŒ‡å®š

      # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹ãŸã‚ã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®š
      - name: Install dependencies ğŸ“¦
        run: npm install
        working-directory: ./kouan-shi

      # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ã‚‹ãŸã‚ã€ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®š
      - name: Build project ğŸ—ï¸
        run: npm run build
        working-directory: ./kouan-shi

      - name: Deploy to GitHub Pages ğŸš€
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # ãƒ“ãƒ«ãƒ‰å¾Œã®å…¬é–‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ­£ã—ãæŒ‡å®š
          publish_dir: ./kouan-shi/dist
          # ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®CNAMEãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
          cname: www.koan-shi.com
